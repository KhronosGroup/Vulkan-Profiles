<!-- markdownlint-disable MD041 -->
<p align="left"><img src="https://vulkan.lunarg.com/img/NewLunarGLogoBlack.png" alt="LunarG" width=263 height=113 /></p>
<p align="left">Copyright © 2021-2022 LunarG, Inc.</p>

<p align="center"><img src="./images/logo.png" width=400 /></p>

[![Creative Commons][3]][4]

[3]: https://i.creativecommons.org/l/by-nd/4.0/88x31.png "Creative Commons License"
[4]: https://creativecommons.org/licenses/by-nd/4.0/

# Vulkan Profiles Tools Overview (BETA)

The Vulkan Profiles Tools are a collection of tools for Vulkan application developers to leverage Vulkan Profiles while developing a Vulkan application and are delivered as part of the Vulkan SDK.

## Vulkan Profiles Tools Design Overview

![Vulkan Profiles](./images/overview.png)

## The Vulkan Profiles JSON Schema

The *Vulkan Profile Schema* aims at providing a human-readable format to store and share data representing Vulkan properties, features, extensions, formats, etc.

It can be used for many different use cases:
- Roadmap profiles: To give guidance on the future direction of the Vulkan API.
- Platform profiles: To express the Vulkan support available on a platform 
- Device profiles: To express the Vulkan support of a device, generated by [GPUInfo.org](https://gpuinfo.org/) at Vulkan 1.3 SDK release and vulkaninfo in the future.
- Engine profiles: To express some rendering code paths requirements of an engine
- Etc.

The Profiles JSON schema allows creating files that store Vulkan features, properties, device memory properties, queue properties and image formats

```
{
    "$schema": "https://schema.khronos.org/vulkan/profiles-1.3.204.json#",
    "capabilities": {
        "baseline": {},
        "advanced": {}
    },
    "profiles": {
        "VP_LUNARG_test_structure_simple": {
            "version": 1,
            "api-version": "1.2.198",
            "label": "LunarG Profiles Structure unit test",
            "description": "For schema unit test on C.I.",
            "contributors": {
                "Christophe Riccio": {
                    "company": "LunarG",
                    "email": "christophe@lunarg.com",
                    "github": "christophe-lunarg",
                    "contact": true
                }
            },
            "history": [
                {
                    "revision": 1,
                    "date": "2021-12-08",
                    "author": "Christophe Riccio",
                    "comment": "Initial revision"
                }
            ],
            "capabilities": [
                "baseline"
            ]
        }
    }
}
```

## Vulkan Profiles Documentation

The *Vulkan Profiles repository* contains a copy of the profile definitions supported by the *Vulkan Profiles Tools*. We are working on a profile documentation generator that will produce a table to compare each profile side by side.

## The Vulkan Profiles API Library

The Vulkan Profiles API is an API separated from the Vulkan API to allow relying on the profile concept on existing shipped devices. While drivers can’t easily be updated, this library can be delivered as part of Vulkan application code.

This library is available in two forms; a C++ header-only library or a C-compatible source and header library that can simply be copied-and-pasted into application or engine code.

After installing the Vulkan SDK, to use the library, simply include <vulkan/vulkan_profiles.hpp>.

Vulkan applications can leverage Vulkan Profiles with the Vulkan Profiles API Library, providing the following features:
- Checking whether specific Vulkan Profiles are supported
- Creating VkDevice instances with the features of a Vulkan Profile enabled
- Reflecting on Vulkan Profiles capabilities

This library is hand-written for the initial release but we are planning to generate it from JSON profile files using a python script so that any Vulkan developer could create a profile and directly use it in C++ code.

Finally, a Vulkan sample will be added to Vulkan-Samples to demonstrate how to use the library.

## The Vulkan Profiles Library API

The Vulkan Profiles library is a helper library that provides the following set of convenience APIs to developers:

* Capability introspection APIs to query the extensions, features, properties, formats, and queue families required by a particular Vulkan profile.
* APIs to verify instance-level and device-level support for a particular Vulkan profile.
* Instance and device creation APIs that automatically enable the extensions and features required by a particular Vulkan profile.

## The Vulkan Profiles Layer

The validation layer assists developers in checking their code for improper use of Vulkan, but these checks take into account only the capabilities of the test platform. To ensure an application properly handles multiple platforms, these checks must be run on all platforms of interest to the Vulkan developer. Combinations of GPUs, ICDs, drivers, and operating systems to name a few factors create an exponential number of possible test platforms, which is infeasible for a developer to obtain and maintain.

The Profile layer seeks to mitigate this obstacle by providing a method to simulate arbitrary Vulkan capabilities from the actual device capabilities to run specific test cases. The layer can be configured using a profile to ensure the application is never using more features than expected, preventing it from not running on expected supported platforms.

The primary function of the Profile layer is simply to simulate the limits, properties, and features of a device, i.e. modifying device responses to query function calls by the application. Of course, the underlying device or driver function are never actually changed, they merely appear to have the limits, properties, and features of a different device or driver. This is different from emulation that would change the actual behavior of the underlying device or driver to match that of a different device or driver.

The Profile layer was previously known as the Device Simulation layer but is not backward compatible due to the change of input files. The Profile layer uses JSON files following the Profile schema while the Device Simulation layer relies on the devsim schema that has a number of problems, firstly not supporting everything Vulkan capabilities.

